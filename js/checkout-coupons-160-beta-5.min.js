!function(e,o){"function"==typeof define&&define.amd?define([],o()):"object"==typeof exports?module.exports=o():e.CheckoutCoupons=o()}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";function n(){var t={},c=!1,e=0;for("[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(c=arguments[0],e++);e<arguments.length;e++)!function(e){for(var o in e)e.hasOwnProperty(o)&&(c&&"[object Object]"===Object.prototype.toString.call(e[o])?t[o]=n(t[o],e[o]):t[o]=e[o])}(arguments[e]);return t}function u(e){var o=document.querySelector(s.messagesWrapperSelector);o&&(o.innerHTML=e)}function c(){var e=document.querySelector(s.messagesWrapperSelector);e&&(e.innerHTML="")}function o(e){var o;e.target.closest(s.addCouponButtonSelector)?(e.preventDefault(),o=e.target.closest(s.addCouponButtonSelector),p(o)):e.target.closest(s.removeCouponButtonSelector)&&(e.preventDefault(),e=e.target.closest(s.removeCouponButtonSelector),i(e))}function t(e){e.defaultPrevented||e.key==a.ENTER&&e.target.closest(s.couponFieldSelector)&&(e.preventDefault(),p())}var r=jQuery,l=!1,d={},s={bodyClass:"has-fc-checkout-coupons",uiProcessingClass:"processing",messagesWrapperSelector:".fc-coupon-code-messages",couponAddedSectionSelector:".fc-step__substep-text-content--coupon-codes",couponFieldSelector:'input[name="coupon_code"]',addCouponButtonSelector:".fc-coupon-code__apply",removeCouponButtonSelector:".woocommerce-remove-coupon",couponCodeAttribute:"data-coupon",expansibleCouponToggleSelector:".fc-expansible-form-section__toggle--coupon_code",expansibleCouponContentSelector:".fc-expansible-form-section__content--coupon_code",expansibleCouponToggleButtonSelector:".expansible-section__toggle-plus--coupon_code"},a={ENTER:"Enter",SPACE:" "},p=function(e){var o="";if(!(o=e&&e.hasAttribute(s.couponCodeAttribute)?e.getAttribute(s.couponCodeAttribute):o)||""==o){e=document.querySelector(s.couponFieldSelector);if(!e)return;o=e.value}o&&""!=o&&d.addCouponCode(o)},i=function(e){var o;e&&(o="",(o=e.hasAttribute(s.couponCodeAttribute)?e.getAttribute(s.couponCodeAttribute):o)&&""!=o&&d.removeCouponCode(o))};d.blockUI=function(e){r(e).addClass(s.uiProcessingClass).block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},d.unblockUI=function(e){r(e).removeClass(s.uiProcessingClass).unblock()},d.addCouponCode=function(e){var o,n;e&&""!=e&&(c(),(o=document.querySelector(s.couponAddedSectionSelector))&&d.blockUI(o),n={security:s.addCouponCodeNonce,coupon_code:e},r.ajax({type:"POST",url:fcSettings.wcAjaxUrl.replace("%%endpoint%%","fc_add_coupon_code"),data:n,dataType:"json",success:function(e){var o,t,c;e.result&&"success"===e.result?(e.message&&u(e.message),(c=document.querySelector(s.couponFieldSelector))&&(c.value=""),window.CollapsibleBlock&&(o=document.querySelector(s.expansibleCouponToggleSelector),t=document.querySelector(s.expansibleCouponContentSelector),c=document.querySelector(s.expansibleCouponToggleButtonSelector),o&&t&&(CollapsibleBlock.collapse(t),CollapsibleBlock.expand(o),c&&c.focus())),r(document.body).trigger("wc_fragment_refresh"),r(document.body).trigger("applied_coupon_in_checkout",[n.coupon_code]),r(document.body).trigger("update_checkout",{update_shipping_method:!1})):e.result&&"error"===e.result&&(u(e.message),(e=document.querySelector(s.couponAddedSectionSelector))&&d.unblockUI(e))}}))},d.removeCouponCode=function(e){var o,t;e&&""!=e&&(c(),(o=document.querySelector(s.couponAddedSectionSelector))&&d.blockUI(o),t={security:s.removeCouponCodeNonce,coupon_code:e},r.ajax({type:"POST",url:fcSettings.wcAjaxUrl.replace("%%endpoint%%","fc_remove_coupon_code"),data:t,dataType:"json",success:function(e){e.result&&"success"===e.result?(e.message&&u(e.message),r(document.body).trigger("wc_fragment_refresh"),r(document.body).trigger("removed_coupon_in_checkout",[t.coupon_code]),r(document.body).trigger("update_checkout",{update_shipping_method:!1})):e.result&&"error"===e.result&&(u(e.message),(e=document.querySelector(s.couponAddedSectionSelector))&&d.unblockUI(e))}}))};function g(){window.addEventListener("click",o),document.addEventListener("keydown",t,!0),document.body.classList.add(s.bodyClass),l=!0}return d.init=function(e){l||(s=n(s,e),window.CollapsibleBlock?g():window.RequireBundle&&RequireBundle.require(["collapsible-block"],function(){g()}),console.log(s.addCouponCodeNonce))},d});
//# sourceMappingURL=maps/checkout-coupons-160-beta-5.min.js.map
